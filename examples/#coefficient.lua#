-- Steel properties
STEEL_YOUNGS_MODULUS = 2e11
STEEL_POISSON_RATIO = 0.3

-- Rubber properties
RUBBER_YOUNGS_MODULUS = 2e7
RUBBER_POISSON_RATIO = 0.45

-- Layering configuration
-- Grid dimensions: z goes from 0 to 1.5
Z_MIN = 0.0
Z_MAX = 1.5
LAYER_THICKNESS = 0.25  -- Thickness of each layer (adjust as needed)

function is_dirichlet(x, y, z)
   return x < 1e-9
end

function youngs_modulus(x, y, z)
   -- Determine which layer based on z-coordinate
   local layer_index = math.floor(z / LAYER_THICKNESS)
   
   -- Alternate between steel (even) and rubber (odd)
   if layer_index % 2 == 0 then
      return STEEL_YOUNGS_MODULUS
   else
      return RUBBER_YOUNGS_MODULUS
   end
end

function poisson_ratio(x, y, z)
   -- Determine which layer based on z-coordinate
   local layer_index = math.floor(z / LAYER_THICKNESS)
   
   -- Alternate between steel (even) and rubber (odd)
   if layer_index % 2 == 0 then
      return STEEL_POISSON_RATIO
   else
      return RUBBER_POISSON_RATIO
   end
end

function lambda(x, y, z)
   E  = youngs_modulus(x, y, z)
   nu = poisson_ratio(x, y, z)
   
   return E * nu / (1. + nu) / (1. - 2. * nu)
end

function mu(x, y, z)
   E  = youngs_modulus(x, y, z)
   nu = poisson_ratio(x, y, z)

   return E / 2 / (1. + nu)
end
     
